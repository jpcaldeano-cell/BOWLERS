<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>BOWLERS</title>

<link rel="apple-touch-icon" sizes="512x512" href="icon-512.png">
<link rel="icon" type="image/png" href="icon-512.png">
<link rel="manifest" href="manifest.json">

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{font-family:-apple-system,system-ui,sans-serif;background:#000;color:#fff;padding:10px;margin:0}
.card{background:#111;border:1px solid #333;border-radius:12px;padding:15px;margin-bottom:15px}
h1{text-align:center;color:#f39c12;font-size:22px;margin:10px 0;letter-spacing:2px}
h2{color:#f39c12;font-size:14px;margin-bottom:10px;border-bottom:1px solid #333;padding-bottom:5px}
label{display:block;margin-top:10px;font-size:11px;color:#aaa;text-transform:uppercase}
input,select{width:100%;padding:12px;margin-top:5px;border-radius:8px;border:1px solid #333;background:#222;color:#fff;font-size:16px}
.row{display:flex;gap:8px}
.row>div{flex:1}
.guardar-btn{background:#f39c12;color:#000;width:100%;padding:15px;border-radius:8px;border:none;font-weight:900;margin-top:15px;font-size:18px;transition:background 0.3s}
.guardar-btn.sucesso{background:#27ae60;color:#000}
table{width:100%;border-collapse:collapse;font-size:12px;margin-top:10px}
th{color:#f39c12;border-bottom:1px solid #333;padding-bottom:6px}
td{text-align:center;padding:8px 0;border-bottom:1px solid #222}
.media-dia{background:#3498db;color:#000;font-weight:900;border-radius:6px}
.apagar-btn{background:#c0392b;color:#fff;border:none;border-radius:6px;padding:5px 10px;font-weight:bold}
.bola-item{display:flex;justify-content:space-between;padding:8px;background:#1a1a1a;margin-bottom:5px;border-radius:6px}
.bola-del-btn{background:#c0392b;color:#fff;border:none;border-radius:6px;padding:4px 10px}
.add-bola-btn{background:#27ae60;color:#000;border:none;border-radius:8px;padding:12px;font-weight:bold;width:100%;margin-top:10px;font-size:16px;cursor:pointer;transition:background 0.3s}
.add-bola-btn:hover{background:#2ecc71}
.footer{font-size:10px;opacity:0.5;text-align:center;margin-top:10px;line-height:1.2;}
</style>
</head>

<body>

<h1>BOWLERS</h1>

<div class="card">
<h2>üéØ REGISTAR TREINO</h2>
<label>Pista</label>
<select id="pista">
  <option value="">Selecionar...</option>
  <option value="CALDAS Bowling">CALDAS Bowling</option>
  <option value="FIGUEIRA DA FOZ">FIGUEIRA DA FOZ</option>
  <option value="SINTRA Beloura">SINTRA Beloura</option>
  <option value="PORTIM√ÉO">PORTIM√ÉO</option>
  <option value="OVAR Bowlikart">OVAR Bowlikart</option>
</select>

<label>Data</label>
<input type="date" id="data">

<div class="row">
<div><label>Bola STRIKE</label><select id="bolaStrike"></select></div>
<div><label>Bola SPARE</label><select id="bolaSpare"></select></div>
</div>

<div class="row">
<div><label>Pontos</label><input type="number" id="pontos"></div>
<div><label>Strikes</label><input type="number" id="strikes"></div>
<div><label>Spares</label><input type="number" id="spares"></div>
</div>

<button id="guardarBtn" class="guardar-btn" onclick="guardar()">GUARDAR REGISTO</button>
</div>

<div class="card">
<h2>üìà EVOLU√á√ÉO</h2>
<canvas id="grafico" style="max-height:180px"></canvas>
<div id="melhorJogo" style="margin-top:10px;font-weight:bold"></div>
</div>

<div class="card">
<h2>üìä HIST√ìRICO</h2>
<table>
<thead>
<tr>
<th>DIA</th>
<th>JOGO</th>
<th>PTS</th>
<th>STR</th>
<th>SPA</th>
<th>MED</th>
<th>STRIKE</th>
<th>SPARE</th>
<th>PISTA</th>
<th>APAGAR</th>
</tr>
</thead>
<tbody id="hist"></tbody>
</table>
</div>

<div class="card">
<h2>üé≥ MINHAS BOLAS</h2>
<div id="listaBolas"></div>
<input id="novaBola" placeholder="Nova bola">
<button class="add-bola-btn" onclick="adicionarBola()">Adicionar</button>
<div class="footer">
<span>Criado por JP Caldeano</span><br>
<span>Vers√£o 1.0 / 2026</span>
</div>
</div>

<script>
const listaPadrao=[
'Raw Hibrida (HAMMER)',
'NoRulesExist (ROTOGRIP)',
'Fire Power (STORM)',
'Ultimate Wrecker (ROTOGRIP)',
'Clear Belmo (STORM)',
'Medusa 8 (VIZ-A-Ball)',
'DV8','RHINO','BRUNSWICK'
];

let bolas=JSON.parse(localStorage.getItem('bolas'))||listaPadrao;
let treinos=JSON.parse(localStorage.getItem('treinos'))||[];
document.getElementById('data').valueAsDate=new Date();
let chart=null;

function atualizarBolas(){
localStorage.setItem('bolas',JSON.stringify(bolas));
const s1=document.getElementById('bolaStrike');
const s2=document.getElementById('bolaSpare');
s1.innerHTML=s2.innerHTML='<option></option>'+bolas.map(b=>`<option>${b}</option>`).join('');
document.getElementById('listaBolas').innerHTML=bolas.map((b,i)=>`
<div class="bola-item">${b}<button class="bola-del-btn" onclick="removerBola(${i})">X</button></div>`).join('');
}

function adicionarBola(){
const n=document.getElementById('novaBola').value.trim();
if(n){bolas.push(n);document.getElementById('novaBola').value='';atualizarBolas();}
}

function removerBola(i){
if(confirm('Apagar bola?')){bolas.splice(i,1);atualizarBolas();}
}

function guardar(){
const btn=document.getElementById('guardarBtn');
const pistaSelecionada = document.getElementById('pista').value;
treinos.push({
  data: document.getElementById('data').value,
  pontos: +document.getElementById('pontos').value,
  strikes: +document.getElementById('strikes').value || 0,
  spares: +document.getElementById('spares').value || 0,
  bolaStrike: document.getElementById('bolaStrike').value,
  bolaSpare: document.getElementById('bolaSpare').value,
  pista: pistaSelecionada
});
localStorage.setItem('treinos',JSON.stringify(treinos));
btn.classList.add('sucesso');
btn.innerText='STRIKE';
setTimeout(()=>{btn.classList.remove('sucesso');btn.innerText='GUARDAR REGISTO'},5000);
document.getElementById('pontos').value=document.getElementById('strikes').value=document.getElementById('spares').value='';
render();
}

function apagarTreino(i){
if(confirm('Apagar este jogo?')){
treinos.splice(i,1);
localStorage.setItem('treinos',JSON.stringify(treinos));
render();
}
}

function render(){
const hist=document.getElementById('hist');
hist.innerHTML='';
const orden=[...treinos].sort((a,b)=>new Date(a.data)-new Date(b.data));
let dias={};

orden.forEach(t=>{
if(!dias[t.data])dias[t.data]=[];
dias[t.data].push(t);
});

Object.keys(dias).forEach(d=>{
const jogos=dias[d];
const media=Math.round(jogos.reduce((s,j)=>s+j.pontos,0)/jogos.length);
jogos.forEach((j,i)=>{
hist.innerHTML+=`
<tr>
<td>${i==0?d.split('-').reverse().slice(0,2).join('/'):''}</td>
<td>${i+1}</td>
<td>${j.pontos}</td>
<td>${j.strikes}</td>
<td>${j.spares}</td>
<td>${i==0?`<span class="media-dia">${media}</span>`:''}</td>
<td>${j.bolaStrike}</td>
<td>${j.bolaSpare}</td>
<td>${j.pista}</td>
<td><button class="apagar-btn" onclick="apagarTreino(${treinos.indexOf(j)})">X</button></td>
</tr>`;
});
});

desenharGrafico();
}

function desenharGrafico(){
const ctx=document.getElementById('grafico');
if(chart)chart.destroy();
const ult=[...treinos].sort((a,b)=>new Date(a.data)-new Date(b.data)).slice(-10);
chart=new Chart(ctx,{
type:'line',
data:{
labels:ult.map(t=>t.data.split('-').reverse().slice(0,2).join('/')),
datasets:[{data:ult.map(t=>t.pontos),borderColor:'#f39c12',fill:true}]
},
options:{plugins:{legend:{display:false}}}
});

// Record + M√©dia Pessoal em duas linhas, centralizado
if(treinos.length){
const melhor=Math.max(...treinos.map(t=>t.pontos));
const mediaTotal=Math.round(treinos.reduce((s,t)=>s+t.pontos,0)/treinos.length);
document.getElementById('melhorJogo').innerHTML=`
<div style="text-align:center;color:#f39c12">üèÜ RECORD PESSOAL: ${melhor}</div>
<div style="text-align:center;color:#fff;margin-top:4px">üî• M√âDIA PESSOAL: ${mediaTotal}</div>
`;
} else {
document.getElementById('melhorJogo').innerHTML='';
}
}

atualizarBolas();
render();
</script>

</body>
</html>
